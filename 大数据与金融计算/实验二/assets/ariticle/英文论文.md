## ğŸ“˜ ä¸€ã€ã€ŠRisk, Return, and Equilibrium: Empirical Testsã€‹ï¼ˆFama & MacBeth, 1973ï¼‰

### ä¸€ã€ç ”ç©¶åŸç†ä¸æ–¹æ³•æ¦‚è¿°

æœ¬ç ”ç©¶å®è¯æ£€éªŒäº†**èµ„æœ¬èµ„äº§å®šä»·æ¨¡å‹ï¼ˆCAPMï¼‰**çš„æœ‰æ•ˆæ€§ï¼Œæå‡ºäº†è‘—åçš„**Fama-MacBeth ä¸¤é˜¶æ®µå›å½’æ³•**ï¼Œç”¨äºä¼°è®¡èµ„äº§é£é™©æº¢ä»·ä¸ç³»ç»Ÿé£é™©ï¼ˆÎ²ï¼‰ä¹‹é—´çš„å…³ç³»ã€‚

**æ ¸å¿ƒå‡è®¾ï¼š**

- æŠ•èµ„è€…é£é™©åŒæ¶ï¼›
- å¸‚åœºå¤„äºå‡è¡¡çŠ¶æ€ï¼›
- æ‰€æœ‰æŠ•èµ„è€…æ‹¥æœ‰ç›¸åŒçš„é¢„æœŸï¼›
- å­˜åœ¨æ— é£é™©èµ„äº§ã€‚

### äºŒã€æ•°å­¦æ¨¡å‹

1. **CAPM åŸºæœ¬æ–¹ç¨‹ï¼š**

\[
E[R_i] = R_f + \beta_i (E[R_m] - R_f)
\]

å…¶ä¸­ï¼š

- \( R_f \)ï¼šæ— é£é™©æ”¶ç›Šç‡ï¼›
- \( R_m \)ï¼šå¸‚åœºç»„åˆæ”¶ç›Šç‡ï¼›
- \( \beta_i = \frac{\mathrm{Cov}(R_i, R_m)}{\mathrm{Var}(R_m)} \)ï¼šèµ„äº§ i çš„ç³»ç»Ÿé£é™©ï¼›
- \( E[R_i] \)ï¼šèµ„äº§ i çš„æœŸæœ›æ”¶ç›Šã€‚

2. **Fama-MacBeth ä¸¤é˜¶æ®µå›å½’æ–¹æ³•ï¼š**

**ç¬¬ä¸€é˜¶æ®µï¼š** å¯¹æ¯åªè‚¡ç¥¨ä¼°è®¡å…¶ Î² å€¼ï¼š

\[
R*{i,t} = \alpha_i + \beta_i R*{m,t} + \epsilon\_{i,t}
\]

**ç¬¬äºŒé˜¶æ®µï¼š** ä½¿ç”¨æ¨ªæˆªé¢å›å½’ä¼°è®¡ Î² ä¸èµ„äº§é¢„æœŸæ”¶ç›Šçš„å…³ç³»ï¼š

\[
R*{i,t} = \gamma*{0,t} + \gamma*{1,t} \hat{\beta}\_i + \eta*{i,t}
\]

ç„¶åå–æ—¶é—´å¹³å‡ä¼°è®¡ \(\gamma_1\) æ˜¯å¦æ˜¾è‘—å¤§äº 0ï¼Œå³æ˜¯å¦æ”¯æŒ CAPMã€‚

### ä¸‰ã€Python ç¤ºä¾‹ä»£ç ï¼ˆå«æ¨¡æ‹Ÿæ•°æ®ï¼‰

```python
import numpy as np
import pandas as pd
import statsmodels.api as sm

# æ¨¡æ‹Ÿå‚æ•°
np.random.seed(42)
n_assets = 10
n_periods = 120  # 10å¹´æœˆåº¦æ•°æ®
rf = 0.02 / 12  # æœˆåº¦æ— é£é™©æ”¶ç›Šç‡
market_excess = np.random.normal(0.01, 0.04, n_periods)

# æ¯åªè‚¡ç¥¨æ”¶ç›Šï¼šR_i,t = alpha + beta * R_m + epsilon
true_betas = np.linspace(0.5, 1.5, n_assets)
alphas = np.random.normal(0, 0.002, n_assets)
residuals = np.random.normal(0, 0.02, (n_periods, n_assets))

# æ¨¡æ‹Ÿèµ„äº§è¶…é¢æ”¶ç›Š
excess_returns = np.array([
    alphas[i] + true_betas[i] * market_excess + residuals[:, i]
    for i in range(n_assets)
]).T

# ç¬¬ä¸€é˜¶æ®µï¼šä¼°è®¡æ¯åªè‚¡ç¥¨çš„ beta_i
estimated_betas = []
for i in range(n_assets):
    X = sm.add_constant(market_excess)
    y = excess_returns[:, i]
    model = sm.OLS(y, X).fit()
    estimated_betas.append(model.params[1])

# ç¬¬äºŒé˜¶æ®µï¼šæ¯æœŸæ¨ªæˆªé¢å›å½’ R_it å¯¹ Î²_i
gamma_1_list = []
for t in range(n_periods):
    y = excess_returns[t, :]
    X = sm.add_constant(estimated_betas)
    model = sm.OLS(y, X).fit()
    gamma_1_list.append(model.params[1])

# ç»Ÿè®¡ç»“æœ
gamma_1_series = pd.Series(gamma_1_list)
print(f"Fama-MacBeth å¹³å‡ Î³â‚ = {gamma_1_series.mean():.4f}, tå€¼ = {gamma_1_series.mean() / gamma_1_series.std(ddof=1) * np.sqrt(n_periods):.2f}")
```

---

## ğŸ“— äºŒã€ã€ŠProfitability of Contrarian Strategies in the Chinese Stock Marketã€‹ï¼ˆShi et al., 2015ï¼‰

### ä¸€ã€ç ”ç©¶åŸç†ä¸æ–¹æ³•æ¦‚è¿°

æœ¬æ–‡åˆ©ç”¨ 1997â€“2012 å¹´æ²ªæ·± A è‚¡æœˆåº¦æ”¶ç›Šæ•°æ®ï¼Œæ£€éªŒäº†**åè½¬ç­–ç•¥ï¼ˆContrarian Strategyï¼‰**åœ¨ä¸­å›½å¸‚åœºçš„æœ‰æ•ˆæ€§ã€‚

**åè½¬ç­–ç•¥åŸºæœ¬æ€æƒ³ï¼š**

> è‚¡ç¥¨åœ¨è¿‡å»è¡¨ç°æœ€å·®ï¼ˆè¾“å®¶ï¼‰çš„è‚¡ç¥¨ï¼Œåœ¨æœªæ¥å¾€å¾€èƒ½è·å¾—è¶…é¢æ”¶ç›Šï¼›åä¹‹ï¼Œè¡¨ç°æœ€å¥½çš„ï¼ˆèµ¢å®¶ï¼‰å¯èƒ½å›è½ã€‚

è¿™ç§ç°è±¡æŒ‘æˆ˜äº†å¼±å¼æœ‰æ•ˆå¸‚åœºå‡è¯´ï¼ˆEMHï¼‰ã€‚

### äºŒã€ç­–ç•¥æ„å»ºä¸æ•°å­¦å®šä¹‰

**â€œJ-K åè½¬ç­–ç•¥â€ï¼š**

1. æ’åºï¼šæŒ‰è¿‡å» \( J \) ä¸ªæœˆæ”¶ç›Šå¯¹æ‰€æœ‰è‚¡ç¥¨æ’åºï¼›
2. åˆ†ç»„ï¼šå½¢æˆèµ¢å®¶ç»„ï¼ˆå‰ decileï¼‰å’Œè¾“å®¶ç»„ï¼ˆå decileï¼‰ï¼›
3. äº¤æ˜“ï¼šä¹°å…¥è¾“å®¶ç»„ \( LOS(J,K) \)ï¼Œå–å‡ºèµ¢å®¶ç»„ \( WIN(J,K) \)ï¼ŒæŒæœ‰ \( K \) ä¸ªæœˆï¼›
4. æ„é€ é›¶æˆæœ¬ç»„åˆï¼š

\[
CON(J,K) = LOS(J,K) - WIN(J,K)
\]

**æ”¶ç›Šè®°å·ï¼š**

- \( L\_{J,K} \)ï¼šè¾“å®¶ç»„åˆå¹´åŒ–å¹³å‡æ”¶ç›Šï¼›
- \( W\_{J,K} \)ï¼šèµ¢å®¶ç»„åˆå¹´åŒ–å¹³å‡æ”¶ç›Šï¼›
- \( C*{J,K} = L*{J,K} - W\_{J,K} \)ï¼šåè½¬ç»„åˆå¹´åŒ–æ”¶ç›Šã€‚

### ä¸‰ã€Python ç¤ºä¾‹ä»£ç ï¼ˆæ¨¡æ‹Ÿåè½¬ç­–ç•¥ï¼‰

```python
import numpy as np
import pandas as pd

np.random.seed(0)
n_stocks = 100
n_months = 60  # æ¨¡æ‹Ÿ5å¹´æ•°æ®

# æ¨¡æ‹Ÿè‚¡ç¥¨æœˆæ”¶ç›Šï¼ˆå¤§è‡´æ­£æ€ï¼‰
returns = pd.DataFrame(np.random.normal(0.01, 0.05, size=(n_months, n_stocks)))

# J-K ç­–ç•¥å‚æ•°
J = 12  # æ’åºæœŸ
K = 6   # æŒæœ‰æœŸ

def contrarian_strategy(data, J, K):
    n_periods = len(data) - J - K
    contrarian_returns = []

    for t in range(n_periods):
        estimation_window = data.iloc[t:t+J]
        holding_window = data.iloc[t+J:t+J+K]

        past_mean = estimation_window.mean()
        losers = past_mean.nsmallest(10).index
        winners = past_mean.nlargest(10).index

        ret_losers = holding_window[losers].mean(axis=1).mean()
        ret_winners = holding_window[winners].mean(axis=1).mean()
        ret_contrarian = ret_losers - ret_winners

        contrarian_returns.append(ret_contrarian)

    return np.mean(contrarian_returns) * 12  # å¹´åŒ–æ”¶ç›Š

annualized_return = contrarian_strategy(returns, J, K)
print(f"{J}-{K}åè½¬ç­–ç•¥å¹´åŒ–æ”¶ç›Šç‡ï¼š{annualized_return:.2%}")
```

### å››ã€æ•°å€¼ä¸¾ä¾‹

å‡è®¾ï¼š

- è¾“å®¶ç»„åˆæœˆæ”¶ç›Šå¹³å‡ï¼š2.1%
- èµ¢å®¶ç»„åˆæœˆæ”¶ç›Šå¹³å‡ï¼š0.8%
- åè½¬ç­–ç•¥æœˆæ”¶ç›Šï¼š1.3%

å¹´åŒ–åè½¬ç­–ç•¥æ”¶ç›Šç‡ä¸ºï¼š
\[
(1 + 0.013)^{12} - 1 \approx 16.7\%
\]
